"use strict";!function(){jQuery(function(n){var e=function(r){var e=r('form[name="checkout"]');return r('form[name="checkout"]').addClass("wc-checkout-add-ons-dropzone"),e.find(":input.select").each(function(e){var t,n=r(this),o=r(this).closest(".form-row").hasClass("validate-required");if(!r(this).data("select2"))return"function"==typeof(t=r(this)).select2&&t.select2({allowClear:!o,placeholder:r(this).attr("multiple")?wc_checkout_add_ons.select_placeholder_multi:wc_checkout_add_ons.select_placeholder_single}).on("select2:unselecting",function(){return r(this).data("unselecting",!0)}).on("select2:opening",function(e){if(r(this).data("unselecting"))return r(this).removeData("unselecting"),e.preventDefault()}),n.is(":focus")&&n.closest(".form-row").find(".select2-selection").focus(),r().select2}),r(function(){return r("#wc_checkout_add_ons :input").on("change",function(e){return r(this).hasClass("select2-search__field")?void r("body").trigger("update_checkout"):t(e)})}),r(function(){return r("#wc_checkout_add_ons .wc-checkout-add-ons-input-file-plupload").each(function(e){var o=r(this),c=o.find(".wc-checkout-add-ons-dropzone"),d=o.find(".wc-checkout-add-ons-preview"),i=o.find(".wc-checkout-add-ons-progress"),s=o.find(".wc-checkout-add-ons-feedback"),a=o.find('input[type="hidden"]'),t=o.parents(".form-row").prop("id"),t={url:wc_checkout_add_ons.ajax_url,multipart_params:{action:"wc_checkout_add_on_upload_file",security:wc_checkout_add_ons.upload_nonce,field:t},browse_button:c[0],drop_element:c[0],multi_selection:1<wc_checkout_add_ons.max_files,filters:{max_file_size:wc_checkout_add_ons.max_file_size,mime_types:wc_checkout_add_ons.mime_types}},n=new plupload.Uploader(t);return n.init(),n.bind("Error",function(e,t){return s.html("\nError #"+t.code+": "+t.message).removeClass("hide"),i.addClass("hide")}),n.bind("FilesAdded",function(e,t){return s.html("").addClass("hide"),c.addClass("disabled"),i.removeClass("hide"),n.start()}),n.bind("UploadProgress",function(e,t){return i.find(".bar").css("width",t.percent+"%")}),n.bind("FileUploaded",function(e,t,n){n=JSON.parse(n.response);return n.errors?(s.html(n.errors.upload_error).removeClass("hide"),i.addClass("hide"),void c.removeClass("disabled")):(a.val(n.id).trigger("change"),d.removeClass("hide").find("a.file").prop("href",n.url).text(n.title),c.addClass("hide").removeClass("disabled"),i.addClass("hide").find(".bar").css("width",0),o.find(".moxie-shim").addClass("hide"))}),o.find("a.remove-file").on("click",function(e){return e.preventDefault(),d.addClass("hide"),c.removeClass("hide disabled"),r.ajax({type:"POST",url:wc_checkout_add_ons.ajax_url,data:{action:"wc_checkout_add_on_remove_file",security:wc_checkout_add_ons.remove_nonce,file:a.val()}}),a.val("").trigger("change"),o.find(".moxie-shim").removeClass("hide")})})})},t=function(e){var t;return n('input[type="file"]').each(function(e){if(n(this).val())return n(this).next().val("1")}),t=n(e.target).attr("id"),n(e.target).one("focusout",function(e){return t=n(e.relatedTarget).attr("id")}),n("body").one("updated_checkout",function(){return n("#"+t).focus(),n("#wc_checkout_add_ons").unblock()}),n("#wc_checkout_add_ons").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),n('form[name="checkout"]').find("select").each(function(e){if(n(this).hasClass("select"))return n(this).select2("destroy")}),n("body").trigger("update_checkout")},o=function(){return n("#wc_checkout_add_ons").find("p.form-row").each(function(){var e=n(this).find(".woocommerce-input-wrapper").find(":input").data("description");if(n(this).find("span.description").remove(),e&&0<e.length)return n(this).append('<span class="description">'+e+"</span>")})};return e(n),o(),n(document).on("updated_checkout",function(){return e(n),o()})})}.call(void 0);